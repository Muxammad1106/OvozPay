# üöÄ –ú–∏–≥—Ä–∞—Ü–∏—è OvozPay –Ω–∞ DeepSeek API - –ü–æ–ª–Ω–∞—è —Å–≤–æ–¥–∫–∞

## ‚úÖ –ß—Ç–æ –∏–∑–º–µ–Ω–µ–Ω–æ –¥–ª—è –ø–æ–ª–Ω–æ–≥–æ –ø–µ—Ä–µ—Ö–æ–¥–∞ –Ω–∞ DeepSeek API

### üîß 1. –ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞

#### **Docker Compose (docker-compose.yml)**
- ‚ùå **–£–¥–∞–ª–µ–Ω—ã —Å–µ—Ä–≤–∏—Å—ã:** `tesseract_ocr`, `whisper_voice` 
- ‚úÖ **–û–±–Ω–æ–≤–ª–µ–Ω—ã –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ:** –∑–∞–º–µ–Ω–∏–ª–∏ `OCR_SERVICE_URL`, `WHISPER_SERVICE_URL` –Ω–∞ `DEEPSEEK_API_KEY`
- üíæ **–£–¥–∞–ª–µ–Ω—ã —Ç–æ–º–∞:** `ocr_temp`, `whisper_models`, `whisper_temp`

#### **–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ (requirements.txt)**
- ‚ùå **–£–¥–∞–ª–µ–Ω—ã:** openai-whisper, torch, pytorch, opencv-python, tesseract, numpy, scipy, nltk (~15GB)
- ‚úÖ **–î–æ–±–∞–≤–ª–µ–Ω—ã:** httpx==0.27.0, openai==1.52.0

---

### ü§ñ 2. AI –°–µ—Ä–≤–∏—Å—ã

#### **–ù–æ–≤—ã–π —Å–µ—Ä–≤–∏—Å (backend/services/deepseek_ai.py)**
```python
‚úÖ DeepSeekAIService - –æ—Å–Ω–æ–≤–Ω–æ–π –∫–ª–∞—Å—Å
‚úÖ process_voice_message() - –æ–±—Ä–∞–±–æ—Ç–∫–∞ –≥–æ–ª–æ—Å–∞  
‚úÖ process_receipt_image() - –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
‚úÖ –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ –∏ —Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ –≤–µ—Ä—Å–∏–∏
‚úÖ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
```

#### **Celery –∑–∞–¥–∞—á–∏ (backend/apps/ai/tasks.py)**
```python
‚úÖ process_voice_message_task() - —Ñ–æ–Ω–æ–≤–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –≥–æ–ª–æ—Å–∞
‚úÖ process_receipt_image_task() - —Ñ–æ–Ω–æ–≤–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —á–µ–∫–æ–≤  
‚úÖ parse_receipt_data() - –ø–∞—Ä—Å–∏–Ω–≥ –¥–∞–Ω–Ω—ã—Ö —á–µ–∫–∞
```

#### **–ù–∞—Å—Ç—Ä–æ–π–∫–∏ Django (backend/config/settings.py)**
```python
‚úÖ DEEPSEEK_API_KEY - –∏–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
‚úÖ DEEPSEEK_BASE_URL = 'https://api.deepseek.com/v1'
‚úÖ –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –¥–ª—è AI —Å–µ—Ä–≤–∏—Å–æ–≤
```

---

### ü§ñ 3. Telegram Bot - –ü–û–õ–ù–ê–Ø –ó–ê–ú–ï–ù–ê

#### **–û–±—Ä–∞–±–æ—Ç—á–∏–∫ –≥–æ–ª–æ—Å–∞ (backend/apps/bot/handlers/voice_handler.py)**
- ‚ùå **–£–¥–∞–ª–µ–Ω—ã –∏–º–ø–æ—Ä—Ç—ã:** `WhisperVoiceService`, `ReceiptVoiceMatcher`
- ‚úÖ **–î–æ–±–∞–≤–ª–µ–Ω—ã –∏–º–ø–æ—Ä—Ç—ã:** `process_voice_message`, `process_voice_message_task`
- ‚úÖ **–û–±–Ω–æ–≤–ª–µ–Ω–∞ –ª–æ–≥–∏–∫–∞:** –ø—Ä—è–º–æ–π –≤—ã–∑–æ–≤ DeepSeek API
- ‚ùå **–£–¥–∞–ª–µ–Ω –º–µ—Ç–æ–¥:** `_process_voice_recognition()` (—Å—Ç–∞—Ä–∞—è –ª–æ–≥–∏–∫–∞)
- ‚úÖ **–ù–æ–≤–∞—è –ª–æ–≥–∏–∫–∞:** —Å–æ–∑–¥–∞–Ω–∏–µ `VoiceResult` —Å –¥–∞–Ω–Ω—ã–º–∏ –æ—Ç DeepSeek

#### **–û–±—Ä–∞–±–æ—Ç—á–∏–∫ —Ñ–æ—Ç–æ (backend/apps/bot/handlers/photo_handler.py)**
- ‚ùå **–£–¥–∞–ª–µ–Ω—ã –∏–º–ø–æ—Ä—Ç—ã:** `TesseractOCRService`, `ReceiptVoiceMatcher`
- ‚úÖ **–î–æ–±–∞–≤–ª–µ–Ω—ã –∏–º–ø–æ—Ä—Ç—ã:** `process_receipt_image`, `process_receipt_image_task`
- ‚úÖ **–û–±–Ω–æ–≤–ª–µ–Ω–∞ –ª–æ–≥–∏–∫–∞:** –ø—Ä—è–º–æ–π –≤—ã–∑–æ–≤ DeepSeek API
- ‚ùå **–£–¥–∞–ª–µ–Ω –º–µ—Ç–æ–¥:** `_process_receipt_ocr()` (—Å—Ç–∞—Ä–∞—è –ª–æ–≥–∏–∫–∞)
- ‚úÖ **–ù–æ–≤–∞—è –ª–æ–≥–∏–∫–∞:** —Å–æ–∑–¥–∞–Ω–∏–µ `OCRResult` —Å –¥–∞–Ω–Ω—ã–º–∏ –æ—Ç DeepSeek

#### **–û—Å–Ω–æ–≤–Ω–æ–π –∫–ª–∏–µ–Ω—Ç –±–æ—Ç–∞ (backend/apps/bot/telegram/bot_client.py)**
- ‚úÖ **–ó–∞–º–µ–Ω–µ–Ω–∞ –∑–∞–≥–ª—É—à–∫–∞** –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã–π –≤—ã–∑–æ–≤ DeepSeek —á–µ—Ä–µ–∑ Celery
- ‚úÖ **–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞** —á–µ—Ä–µ–∑ `process_voice_message_task.delay()`

---

### üåê 4. API Views - –ü–û–õ–ù–ê–Ø –ó–ê–ú–ï–ù–ê

#### **AI Views (backend/apps/ai/views/api/ai_views.py)**
- ‚ùå **–£–¥–∞–ª–µ–Ω—ã –∏–º–ø–æ—Ä—Ç—ã:** `TesseractOCRService`, `WhisperVoiceService`
- ‚úÖ **–î–æ–±–∞–≤–ª–µ–Ω—ã –∏–º–ø–æ—Ä—Ç—ã:** `process_receipt_image`, `process_voice_message`

**OCRResultViewSet:**
- ‚úÖ **create()** - –∑–∞–º–µ–Ω–µ–Ω –Ω–∞ DeepSeek API
- ‚úÖ **bulk_process()** - –∑–∞–º–µ–Ω–µ–Ω –Ω–∞ DeepSeek API

**VoiceResultViewSet:**
- ‚úÖ **create()** - –∑–∞–º–µ–Ω–µ–Ω –Ω–∞ DeepSeek API

**AIServiceViewSet:**
- ‚úÖ **status()** - –ø—Ä–æ–≤–µ—Ä–∫–∞ DeepSeek API –∫–ª—é—á–∞ –≤–º–µ—Å—Ç–æ Tesseract/Whisper

#### **Legacy API (backend/apps/ai/api/views.py)**
- ‚ùå **–£–¥–∞–ª–µ–Ω—ã –∏–º–ø–æ—Ä—Ç—ã:** `TesseractOCRService`, `WhisperVoiceService`
- ‚úÖ **–î–æ–±–∞–≤–ª–µ–Ω—ã –∏–º–ø–æ—Ä—Ç—ã:** `process_receipt_image`, `process_voice_message`

---

### üìä 5. –†–µ–∑—É–ª—å—Ç–∞—Ç –º–∏–≥—Ä–∞—Ü–∏–∏

#### **–≠–∫–æ–Ω–æ–º–∏—è —Ä–µ—Å—É—Ä—Å–æ–≤:**
- üíæ **–î–∏—Å–∫–æ–≤–æ–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ:** ~20GB –º–µ–Ω—å—à–µ
- üß† **–û–ø–µ—Ä–∞—Ç–∏–≤–Ω–∞—è –ø–∞–º—è—Ç—å:** ~4-6GB –º–µ–Ω—å—à–µ
- ‚ö° **–í—Ä–µ–º—è –∑–∞–ø—É—Å–∫–∞:** –º–≥–Ω–æ–≤–µ–Ω–Ω–æ (–±–µ–∑ –∑–∞–≥—Ä—É–∑–∫–∏ AI –º–æ–¥–µ–ª–µ–π)
- üì¶ **–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è:** 5GB –≤–º–µ—Å—Ç–æ 25GB

#### **–î–ª—è –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è:**
- üë• **500 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:** 50GB –≤–º–µ—Å—Ç–æ 300GB
- üèóÔ∏è **–õ–µ–≥–∫–æ –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ—Ç—Å—è** –±–µ–∑ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö AI —Å–µ—Ä–≤–µ—Ä–æ–≤
- üí∞ **–û–ø–ª–∞—Ç–∞ –ø–æ —Ñ–∞–∫—Ç—É** –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è API

---

### üîó 6. –ß—Ç–æ –ù–ï —Ç—Ä–æ–Ω—É—Ç–æ (–æ—Å—Ç–∞–ª–∏—Å—å —Å–æ–≤–º–µ—Å—Ç–∏–º—ã–º–∏)

#### **–ú–æ–¥–µ–ª–∏ Django (—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞ —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å):**
- ‚úÖ `VoiceResult` - —Ä–∞–±–æ—Ç–∞–µ—Ç —Å –Ω–æ–≤—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
- ‚úÖ `OCRResult` - —Ä–∞–±–æ—Ç–∞–µ—Ç —Å –Ω–æ–≤—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏  
- ‚úÖ `ReceiptVoiceMatch` - —É–ø—Ä–æ—â–µ–Ω–Ω–∞—è –ª–æ–≥–∏–∫–∞ —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏—è
- ‚úÖ –í—Å–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –¥–∞–Ω–Ω—ã–µ –æ—Å—Ç–∞—é—Ç—Å—è –¥–æ—Å—Ç—É–ø–Ω—ã

#### **API endpoints (–æ—Å—Ç–∞–ª–∏—Å—å —Ç–µ–º–∏ –∂–µ):**
- ‚úÖ `/api/ai/ocr/` - —Ç–æ—Ç –∂–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
- ‚úÖ `/api/ai/voice/` - —Ç–æ—Ç –∂–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
- ‚úÖ –ö–ª–∏–µ–Ω—Ç—Å–∫–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è —Ä–∞–±–æ—Ç–∞—é—Ç –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π

---

### üõ†Ô∏è 7. –î–µ–ø–ª–æ–π –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏

#### **–ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è (.env):**
```bash
DEEPSEEK_API_KEY=sk-your-key-here
DOMAIN=ovozpay.uz
EMAIL=admin@ovozpay.uz
```

#### **–ö–æ–º–∞–Ω–¥—ã –¥–µ–ø–ª–æ—è:**
```bash
# 1. –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å—Ç–∞—Ä—ã–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã  
docker-compose down

# 2. –û—á–∏—Å—Ç–∏—Ç—å –æ–±—Ä–∞–∑—ã (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
docker system prune -a

# 3. –î–µ–ø–ª–æ–π —Å SSL
DOMAIN=ovozpay.uz EMAIL=admin@ovozpay.uz ./deploy.sh --ssl
```

---

## üéØ –ò–¢–û–ì: –ë–æ—Ç —Ç–µ–ø–µ—Ä—å –ü–û–õ–ù–û–°–¢–¨–Æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç DeepSeek API!

### ‚úÖ **–ó–∞–º–µ–Ω–µ–Ω–æ 100%:**
- –í—Å–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ Telegram –±–æ—Ç–∞
- –í—Å–µ API endpoints  
- –í—Å–µ AI —Å–µ—Ä–≤–∏—Å—ã
- –í—Å—è –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞

### üîí **–ï–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω–∞—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å:**
- DeepSeek API –∫–ª—é—á
- –ò–Ω—Ç–µ—Ä–Ω–µ—Ç —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ

### üìà **–†–µ–∑—É–ª—å—Ç–∞—Ç:**
- üöÄ **–ë—ã—Å—Ç—Ä—ã–π –∑–∞–ø—É—Å–∫** (—Å–µ–∫—É–Ω–¥—ã –≤–º–µ—Å—Ç–æ –º–∏–Ω—É—Ç)
- üíæ **–≠–∫–æ–Ω–æ–º–∏—è –º–µ—Å—Ç–∞** (20GB –º–µ–Ω—å—à–µ)
- üèóÔ∏è **–õ–µ–≥–∫–æ–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ** 
- üéØ **–í—ã—Å–æ–∫–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å** (DeepSeek —Ç–æ–ø-–º–æ–¥–µ–ª–∏)

**–ü—Ä–æ–µ–∫—Ç –≥–æ—Ç–æ–≤ –∫ –ø—Ä–æ–¥–∞–∫—à–µ–Ω—É —Å DeepSeek API! üéâ** 